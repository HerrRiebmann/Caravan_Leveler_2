/* =============================================================
	Caravan Leveler UI Styles (Repaired & Refactored)
	- Introduces CSS variable --brand
	- Cleans up previous corruption
	- Preserves original class names for compatibility
	- Unifies value-display offset while keeping old class hooks
	============================================================= */

:root { --brand: #008CBA; }

/* Base */
html { font-family: Helvetica; display:inline-block; margin:0 auto; text-align:center; color:#fff; height:100%; }
body { height:95%; margin:0; }
h1 { color: var(--brand); padding:1vh; text-shadow:2px 2px #e1e4e8; margin:0 0 .5rem 0; }
p { font-size:1rem; }

/* Card */
.card { box-shadow:0 4px 8px rgba(0,0,0,0.2); transition:.3s; background:DarkGray; min-width:350px; width:80%; height:100%; margin:auto; background-image:url('caravan.png'); background-repeat:no-repeat; background-position:center 40px; position:relative; }

/* Inputs / Buttons */
input { text-align:center; }
input[type=text] { font-size:20px; }
button { cursor:pointer; background:var(--brand); border:none; border-radius:4px; color:#c4d9f5; padding:15px 32px; font-size:16px; box-shadow:0 8px 16px rgba(0,0,0,0.2),0 6px 20px rgba(0,0,0,0.19); width:200px; margin:5px auto; display:inline-block; }
button:hover { color:#fff; box-shadow:0 12px 16px rgba(0,0,0,0.24),0 17px 50px rgba(0,0,0,0.19); }
canvas { box-shadow:0 8px 16px rgba(0,0,0,0.2),0 6px 20px rgba(0,0,0,0.19); border-radius:2px; }

/* Layout helpers */
.setupDiv { display:flex; justify-content:center; }
.centered { position:fixed; top:50%; left:30%; transform:translateY(-50%); }

/* Settings grid */
div.settings { display:grid; grid-template-columns:max-content max-content; gap:5px; }
div.settings label { text-align:right; }
div.settings label:after { content:":"; }
div.settings input { font-size:medium; }

/* Advanced Settings */
#AdvancedSettings { display:none; border:1px solid var(--brand); border-radius:8px; padding:15px; margin:10px 0; background:rgba(0,140,186,0.1); transition:all .3s ease; }
#AdvancedSettings h3 { color:var(--brand); margin:0 0 15px 0; font-size:1.2em; text-align:center; }
#AdvancedSettings p { margin:8px 0; }
#AdvancedSettings input[type=number], #AdvancedSettings input[type=text] { width:120px; padding:5px; border:1px solid #ccc; border-radius:4px; background:#fff; color:#333; font-size:medium; }
#AdvancedSettings input[type=number] { width:80px; }
.advanced-toggle { position:relative; width:80%; max-width:300px; margin:20px auto 10px; text-align:center; font-size:.9em; color:var(--brand); background:rgba(255,255,255,0.9); padding:8px 12px; border-radius:5px; border:1px solid var(--brand); z-index:15; }
.advanced-toggle label { margin-right:5px; cursor:pointer; }
.advanced-toggle input[type=checkbox] { cursor:pointer; }

/* Modal / dimmer */
.modal { display:block; }
.dimmer { background:#000; opacity:.6; position:fixed; inset:0; display:none; z-index:100; }

/* Utilities */
.brand-color { color:var(--brand); font-weight:bold; }

/* Chart / upload */
#chart-container { margin:15px auto; text-align:center; }
.upload-btn-wrapper { position:relative; overflow:hidden; display:inline-block; }
.upload-btn-wrapper input[type=file] { font-size:100px; position:absolute; left:0; top:0; opacity:0; cursor:pointer; }

/* Navigation */
#BurgerMenu { top:25px; left:15px; right:auto; position:fixed; z-index:100; text-align:left; background:transparent; }
#BurgerMenu .hamburger { display:block; position:relative; z-index:2; }
.hamburger .line { width:50px; height:5px; background:#555; display:block; margin:8px auto; transition:all .3s ease-in-out; }
.hamburger:hover { cursor:pointer; }
#BurgerMenu .hamburger { transition:all .35s ease-in-out; }
#BurgerMenu.menu-open .hamburger { position:absolute; top:6px; right:8px; left:auto; margin:0; }
#hamburger-6.is-active { transition:all .35s ease-in-out; transform:rotate(45deg); }
#hamburger-6.is-active .line:nth-child(2) { width:0; }
#hamburger-6.is-active .line:nth-child(1), #hamburger-6.is-active .line:nth-child(3) { transition-delay:.15s; }
#hamburger-6.is-active .line:nth-child(1) { transform:translateY(13px); }
#hamburger-6.is-active .line:nth-child(3) { transform:translateY(-13px) rotate(90deg); }
#myLinks { display:none; }
/* Panel styling + animations */
#BurgerMenu.menu-open { background:DarkGray; padding:10px 12px 12px 12px; border:1px solid #1C658C; box-shadow:0 4px 8px rgba(0,0,0,0.25); border-radius:4px; }
#BurgerMenu.menu-open #myLinks { display:block; margin-top:56px; animation:menuFadeSlide .28s ease forwards; transform-origin: top left; }
#BurgerMenu.menu-closing #myLinks { animation:menuFadeSlideOut .2s ease forwards; }
#BurgerMenu.menu-open .hamburger { margin-bottom:2px; }

@keyframes menuFadeSlide { 0% { opacity:0; transform:translateY(-6px) scale(.97); } 60% { opacity:1; } 100% { opacity:1; transform:translateY(0) scale(1); } }
@keyframes menuFadeSlideOut { 0% { opacity:1; transform:translateY(0) scale(1); } 100% { opacity:0; transform:translateY(-6px) scale(.97); } }

/* Iframe container */
.iFrameDiv { display:flex; width:100%; height:95%; flex-direction:column; background:#D3DEDC; overflow:hidden; }
#subframe { position:relative; flex-grow:1; border:none; margin:0; padding:0; display:block; height:100vh; }

/* Output message pill */
#Output { display:none; }
#Output.output-enhanced { font-weight:bold; color:var(--brand); position:absolute; bottom:30px; left:50%; transform:translateX(-50%); text-align:center; z-index:1000; background:rgba(70,70,70,0.78); padding:6px 14px; border-radius:18px; display:inline-block; backdrop-filter:blur(2px); -webkit-backdrop-filter:blur(2px); box-shadow:0 4px 10px rgba(0,0,0,0.35); max-width:90%; white-space:normal; opacity:0; transition:opacity .35s ease, background-color .3s ease, box-shadow .3s ease, color .3s ease; }
#Output.output-visible { opacity:1; }
#Output.output-fade-out { opacity:0; }
#Output.output-error { background:rgba(200,40,30,0.9)!important; color:#fff!important; box-shadow:0 4px 14px rgba(200,40,30,0.55); }
#Output.output-cleared { background:none!important; box-shadow:none!important; padding:0!important; }
.voltageSpan, .temperatureSpan { font-weight:bold; color:var(--brand); position:absolute; bottom:10px; font-size:.9em; }
.voltageSpan { left:10px; }
.temperatureSpan { right:10px; }

/* Bubble level */
.value-display { position:absolute; left:50%; transform:translateX(-50%); font-weight:bold; color:#2c3e50; background:rgba(255,255,255,0.8); padding:2px 8px; border-radius:6px; font-size:1.1em; pointer-events:none; z-index:10; }
.value-display.top-offset, .value-display-vertical, .value-display-horizontal { top:-25px; }
.level-container { display:block; justify-content:space-around; flex-wrap:wrap; margin-top:6rem; margin-left:auto; margin-right:auto; width:50%; height:80%; padding:10px; }
.level { background:#a4c639; border-radius:10px; position:relative; margin:1rem; box-shadow:inset 0 0 10px rgba(0,0,0,0.3); overflow:visible; padding-top:20px; }
.horizontal { width:150px; height:25px; top:80px; margin:-20px auto 0; }
.vertical { width:40px; height:120px; top:10px; margin:-20px auto 0; }
.bubble { position:absolute; background:rgba(255,255,102,0.7); border-radius:50%; width:30px; height:30px; top:50%; left:50%; transform:translate(-50%, -50%); box-shadow:0 0 10px rgba(0,0,0,0.4); transition:left .42s cubic-bezier(.22,.61,.36,1), top .42s cubic-bezier(.22,.61,.36,1), background-color .3s linear, transform .42s cubic-bezier(.22,.61,.36,1); z-index:1; overflow:hidden; }
@keyframes bubbleIntroX { 0% { left:12%; } 40%,60% { left:88%; } 100% { left:50%; } }
@keyframes bubbleIntroY { 0% { top:15%; } 40%,60% { top:85%; } 100% { top:50%; } }
.bubble-intro-x { animation:bubbleIntroX 2.2s ease-in-out infinite alternate; }
.bubble-intro-y { animation:bubbleIntroY 2.2s ease-in-out infinite alternate; }
.bubble.settling { animation:bubbleSettle .5s ease-out; }
@keyframes bubbleSettle { from { transform:translate(-50%, -50%) scale(1.1); } to { transform:translate(-50%, -50%) scale(1); } }
.bubble::after { content:""; position:absolute; top:5%; left:5%; width:60%; height:60%; border-radius:50%; background:rgba(255,255,255,0.4); filter:blur(3px); }
.level::before, .level::after { content:""; position:absolute; background:rgba(0,0,0,0.5); z-index:2; }
.horizontal::before, .horizontal::after { width:2px; height:100%; top:0; }
.horizontal::before { left:45%; }
.horizontal::after { left:55%; }
.vertical::before, .vertical::after { width:100%; height:2px; left:0; }
.vertical::before { top:45%; }
.vertical::after { top:55%; }

/* Data tables */
table { border:2px solid #fff; width:100%; text-align:center; border-collapse:collapse; }
table td, table th { border:1px solid #fff; padding:3px 4px; }
table tbody td { font-size:13px; }
table td:nth-child(even) { background:#EBEBEB; }
table tbody tr:hover { background:#ddd; }
table thead { background:#fff; border-bottom:4px solid #333; }
table thead th { font-size:15px; font-weight:bold; color:#333; text-align:center; border-left:2px solid #333; }
table thead th:first-child { border-left:none; }

/* Tooltips */
[data-tooltip] { position:relative; cursor:help; }
[data-tooltip]::after { content:attr(data-tooltip); position:absolute; bottom:100%; left:50%; transform:translate(-50%, -5px); padding:8px 12px; background:rgba(0,0,0,0.9); color:#fff; border-radius:6px; font-size:14px; white-space:normal; max-width:250px; text-align:center; z-index:1000; opacity:0; visibility:hidden; transition:opacity .3s ease, visibility .3s ease, transform .3s ease; pointer-events:none; box-shadow:0 2px 8px rgba(0,0,0,0.3); }
[data-tooltip]::before { content:""; position:absolute; bottom:100%; left:50%; transform:translate(-50%,8px); width:0; height:0; border-left:6px solid transparent; border-right:6px solid transparent; border-top:6px solid rgba(0,0,0,0.9); z-index:1000; opacity:0; visibility:hidden; transition:opacity .3s ease, visibility .3s ease, transform .3s ease; }
[data-tooltip]:hover::after { opacity:1; visibility:visible; transform:translate(-50%,0); transition-delay:.5s; }
[data-tooltip]:hover::before { opacity:1; visibility:visible; transform:translate(-50%,2px); transition-delay:.5s; }

/* Serial monitor */
.serial-controls { margin:15px 0; display:flex; justify-content:center; gap:10px; flex-wrap:wrap; }
.serial-controls button { width:auto; min-width:120px; padding:8px 16px; font-size:14px; margin:2px; }
.interval-control { margin:10px 0; display:flex; flex-direction:column; justify-content:center; align-items:center; gap:5px; }
.interval-control label { color:var(--brand); font-weight:bold; font-size:14px; }
.slider { -webkit-appearance:none; appearance:none; width:80%; max-width:300px; height:15px; border-radius:5px; background:#d3d3d3; outline:none; opacity:.7; transition:opacity .2s; }
.slider:hover { opacity:1; }
.slider::-webkit-slider-thumb { -webkit-appearance:none; appearance:none; width:25px; height:25px; border-radius:50%; background:var(--brand); cursor:pointer; }
.slider::-moz-range-thumb { width:25px; height:25px; border-radius:50%; background:var(--brand); cursor:pointer; border:none; }
.log-container { margin:15px auto; max-width:90%; }
.log-container textarea { width:100%; max-width:100%; min-height:400px; resize:vertical; font-family:'Courier New',Consolas,monospace; font-size:12px; background:#1e1e1e; color:#00ff00; border:2px solid var(--brand); border-radius:4px; padding:10px; box-sizing:border-box; }
.log-container textarea:focus { outline:none; border-color:#BA2E00; box-shadow:0 0 5px rgba(186,46,0,0.5); }
#log { white-space:pre-wrap; font-family:monospace; background:#1e1e1e; color:#00ff00; border:1px solid var(--brand); }

/* Rotated image leveler */
.rotation-container { display:flex; flex-direction:column; align-items:center; justify-content:flex-start; gap:2.2rem; margin-top:3rem; position:relative; }
.rotation-unit { position:relative; }
.scale-wrapper { position:relative; width:200px; height:200px; margin:auto; }
.semi-scale { width:100%; height:110px; position:absolute; top:0; left:0; }
.rot-image { position:absolute; top:100px; left:50%; width:120px; height:120px; transform:translate(-50%, -50%) rotate(0deg); transform-origin:50% 50%; transition:transform .35s cubic-bezier(.22,.61,.36,1); filter:drop-shadow(0 4px 6px rgba(0,0,0,0.4)); user-select:none; pointer-events:none; }
.rot-image.settling-img { animation:imgSettle .5s ease-out; }
@keyframes imgSettle { from { transform:translate(-50%, -50%) scale(1.1); } to { transform:translate(-50%, -50%) scale(1); } }
.angle-value { position:absolute; background:rgba(255,255,255,0.85); padding:2px 8px; border-radius:6px; font-weight:bold; color:#222; font-size:1.05em; min-width:56px; pointer-events:none; box-shadow:0 2px 4px rgba(0,0,0,0.3); transition:left .35s cubic-bezier(.22,.61,.36,1), top .35s cubic-bezier(.22,.61,.36,1), background-color .3s ease; }
.axis-label { position:absolute; bottom:10px; left:50%; transform:translateX(-50%); font-weight:bold; color:var(--brand); font-size:.9em; }

/* Toggle button */
.view-toggle { position:absolute; top:10px; right:10px; width:42px; height:42px; border-radius:50%; border:none; background:var(--brand); color:#fff; font-size:1.3em; cursor:pointer; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 8px rgba(0,0,0,0.3); transition:background .25s ease, transform .2s ease; z-index:20; }
.view-toggle:hover { background:#0a9ed3; }
.view-toggle:active { transform:scale(.9); }

/* Gyro permission button */
.gyro-permission-btn { position:absolute; top:10px; right:60px; width:42px; height:42px; border-radius:50%; border:none; background:#ff6b35; color:#fff; font-size:1.3em; cursor:pointer; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 8px rgba(0,0,0,0.3); transition:background .25s ease, transform .2s ease; z-index:20; animation:pulse 2s infinite; }
.gyro-permission-btn:hover { background:#ff8555; }
.gyro-permission-btn:active { transform:scale(.9); }

@keyframes pulse {
  0% { box-shadow:0 4px 8px rgba(0,0,0,0.3); }
  50% { box-shadow:0 4px 8px rgba(255,107,53,0.5), 0 0 20px rgba(255,107,53,0.3); }
  100% { box-shadow:0 4px 8px rgba(0,0,0,0.3); }
}

/* Images */
.mpu6050-image { width:80px; height:80px; cursor:alias; transition:transform .3s ease; margin:10px auto; display:block; }